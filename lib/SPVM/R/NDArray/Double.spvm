# Copyright (c) 2023 Yuki Kimoto
# MIT License

class R::NDArray::Double {
  
  # Interface
  interface R::NDArray;
  
  # Fields
  has array : double[];
  
  has dim : int[];
  
  # Class Methods
  static method new : R::NDArray::Double : ($dim : int[], $array : double[] = undef) {
    
    my $array_length = -1;
    if ($array) {
      $array_length = @$array;
    }
    
    R::NDArray->init_partially($dim, $array_length);
    
    my $self = new R::NDArray::Double;
    
    if ($array) {
      $self->{array} = (double[])copy $array;
    }
    else {
      $self->{array} = new double[$array_length];
    }
    
    return $self;
  }
  
  # Instance Methods
  method length : int {
    return $self->R::NDArray::length;
  }
  
  method to_array : double[] () {
    return (double[])copy $self->{array};
  }
  
  method get_array_unsafe : double[] () {
    return $self->{array};
  }
  
  method dim : int[] () {
    return (int[])copy $self->{dim};
  }
  
  method set_dim : void ($dim : int[]) {
    return $self->R::NDArray::set_dim($dim);
  }
}
